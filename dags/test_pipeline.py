"""
test_pipeline
DAG auto-generated by Astro Cloud IDE.
"""

from airflow.decorators import dag
from astro import sql as aql
import pandas as pd
import pendulum


@aql.dataframe(task_id="my_dag")
def my_dag_func():
     import datetime
    
     from airflow import DAG
     from airflow.operators.empty import EmptyOperator
    
     my_dag = DAG(
         dag_id="my_dag_name",
         start_date=datetime.datetime(2021, 1, 1),
     )
     EmptyOperator(task_id="task", dag=my_dag)

@aql.dataframe(task_id="python_2")
def python_2_func():
    import datetime
    
    from airflow.decorators import dag
    from airflow.operators.empty import EmptyOperator
    
    
    @dag(start_date=datetime.datetime(2021, 1, 1))
    def generate_dag():
        EmptyOperator(task_id="task")
    
    
    generate_dag()

@dag(
    schedule="0 0 * * *",
    start_date=pendulum.from_format("2023-08-01", "YYYY-MM-DD").in_tz("UTC"),
    catchup=False,
)
def test_pipeline():
    my_dag = my_dag_func()

    python_2 = python_2_func()

dag_obj = test_pipeline()
